<p>“secure”属性阻止cookie通过明文连接(如HTTP)发送，因为它们很容易被窃听。相反，带有secure属性的cookie只通过加密的HTTPS连接发送。</p>
<h2>推荐的安全编码实践</h2>
<ul>
  <li> 将<code>setcookie</code>函数的最后一个参数设置为"true" </li>
  <li> 在php.ini文件里设置<code>session.cookie_secure = 1</code> </li>
</ul>
<h2>不合规的代码示例</h2>
<pre>
; 在php.ini内
session.cookie_secure = 0  ;不合规

//使用PHP代码
session_set_cookie_params($lifetime, $path, $domain, false); // 不合规，最后一个参数表示会话cookie应该不是安全的

setcookie($name, $value, $expire, $path, $domain, false); // 不合规，最后一个参数表示cookie应该不是安全的
</pre>
<h2>请参阅</h2>
<ul>
  <li> <a href="http://cwe.mitre.org/data/definitions/311">MITRE, CWE-311</a> - Missing Encryption of Sensitive Data </li>
  <li> <a href="http://cwe.mitre.org/data/definitions/315">MITRE, CWE-315</a> - Cleartext Storage of Sensitive Information in a Cookie </li>
  <li> <a href="http://cwe.mitre.org/data/definitions/614">MITRE, CWE-614</a> - Sensitive Cookie in HTTPS Session Without 'Secure' Attribute </li>
  <li> OWASP Top 10 2017 Category A2 - Broken Authentication </li>
  <li> OWASP Top 10 2017 Category A3 - Sensitive Data Exposure </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat3">SANS Top 25</a> - Porous Defenses </li>
</ul>

