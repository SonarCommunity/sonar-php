<p>必须正确实施应用程序的访问控制，以限制对授权实体的资源访问，否则可能导致漏洞：</p>
<ul>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-12999">CVE-2018-12999</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-10285">CVE-2018-10285</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-7455">CVE-2017-7455</a> </li>
</ul>
<p>因此，必须谨慎地授予用户，应用程序，组或角色正确的权限并定义允许访问资源的所需权限。
例如，很明显，只有具有管理员权限的用户才应被授权添加/删除另一个用户的管理员权限。</p>
<h2>检查是否存在以下情况</h2>
<ul>
  <li>授予实体（用户，应用程序）的权限允许访问该实体不需要的信息或功能。</li>
  <li>特权很容易获得（例如：根据用户的位置，由第三方定义的使用的设备类型不需要批准...）</li>
  <li>继承的权限，默认权限，没有特权（例如：匿名用户）被授权访问受保护的资源。</li>
</ul>
<p>若存在以上情况，则代码存在风险</p>
<h2>推荐的安全编码实践</h2>
<p>至少，访问控制系统应：</p>
<ul>
  <li>使用定义良好的访问控制模型，例如<a href="https://en.wikipedia.org/wiki/Role-based_access_control"> RBAC </a>或<a href ="https：//en.wikipedia.org/wiki/Access-control_list"> ACL </a></li>
  <li>应该定期检查实体的权限，以删除不再需要的权限。</li>
  <li>遵循<a href="https://en.wikipedia.org/wiki/Principle_of_least_privilege">最小特权原则</a> ("_实体只能访问其合法目的所需的信息和资源_"). </li>
</ul>
<h2>敏感代码示例</h2>
<p>CakePHP</p>
<pre>
use Cake\Auth\BaseAuthorize;
use Cake\Controller\Controller;

abstract class MyAuthorize extends BaseAuthorize { // 敏感的。 扩展Cake\Auth\BaseAuthorize的方法。
    // ...
}

// 请注意，仅在Cake\Controller\Controller的直接子类中才能检测到“ isAuthorized”方法。
abstract class MyController extends Controller {
    public function isAuthorized($user) { // 敏感的。 在Cake\Controller\Controller中，名为isAuthorized的方法。
        return false;
    }
}
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://www.owasp.org/index.php/Top_10-2017_A5-Broken_Access_Control">OWASP Top 10 2017 Category A5</a> - Boken Access Control </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat3">SANS Top 25</a> - Porous Defenses </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/276.html">MITRE, CWE-276</a> - Incorrect Default Permissions </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/732.html">MITRE, CWE-732</a> - Incorrect Permission Assignment for Critical Resource </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/668.html">MITRE, CWE-668</a> - Exposure of Resource to Wrong Sphere </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/277.html">MITRE, CWE-277</a> - Insecure Inherited Permissions </li>
</ul>
<h2>Deprecated</h2>
<p>This rule is deprecated, and will eventually be removed.</p>

